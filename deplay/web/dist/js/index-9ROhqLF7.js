import{h6 as N,r as s,j as e,Y as O,h7 as D,V as C,ha as F,hb as M,hc as T,l as j,hl as A}from"./vendor-core-BL9Phd6R.js";import{e as L,b as V,u as _,c as v,d as H}from"./index-iws3EgzL.js";import{u as K}from"./useSearchForm-DGLxIQDe.js";import"./route-login-p179xrQD.js";import"./route-layout-De7MC9tK.js";const Y=()=>{const[r]=N(),[n,h]=s.useState(10),[c,p]=s.useState(1),[x,l]=s.useState(0),[b,d]=s.useState(!1),[z,g]=s.useState([]),[S,R]=s.useState([]),[m,o]=s.useState(),[f,I]=s.useState(!1),[B,u]=s.useState(!1),y=[{label:"蜂鸣器规则",name:"buzzerRule",component:e.jsx(C,{allowClear:!0})}],{SearchFormComponent:E}=K({getDataRequestFn:t=>i(t),onNewRecordFn:()=>{I(!1),u(!0),r.resetFields()},formItems:y,operateComponent:!!z.length&&e.jsx(O,{type:"primary",icon:e.jsx(D,{}),onClick:()=>L(z),children:"导出"}),formName:"buzzerSearchForm"}),i=t=>{d(!0),V({limit:n,offset:(c-1)*n,...t}).then(a=>{R(a.data.list),l(a.data.total)}).finally(()=>{d(!1)})},k=t=>{F.confirm({title:"确认删除",content:t.length>1?"确定要删除选中的规则吗？":"确定要删除该规则吗？",okText:"确定",cancelText:"取消",onOk:()=>{H(t).then(()=>i())}})},q=async t=>{o(t),I(!0),u(!0),r.setFieldsValue(t)},P=()=>{r.validateFields().then(t=>{if(f&&m){const a={buzzerId:m.buzzerId,buzzerRule:t.buzzerRule};_(a).then(()=>{u(!1),i()})}else{const a={buzzerRule:t.buzzerRule};v(a).then(()=>{u(!1),i()})}})},w=[{title:"蜂鸣器ID",dataIndex:"buzzerId",key:"buzzerId"},{title:"蜂鸣器规则",dataIndex:"buzzerRule",key:"buzzerRule"},{title:"操作",key:"action",align:"center",render:(t,a)=>e.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[e.jsx("span",{onClick:()=>q(a),children:"编辑"}),e.jsx("span",{className:"text-red-500",onClick:()=>k([a.buzzerId]),children:"删除"})]})}];return s.useEffect(()=>{},[B]),s.useEffect(()=>{i()},[n,c]),{list:S,roleColumns:w,SearchFormComponent:E,total:x,limit:n,loading:b,isEdit:f,formRef:r,editBuzzersModalOpen:B,setPage:p,setLimit:h,setSelected:g,setEditBuzzersModalOpen:u,onFinish:P}},G=()=>{const{list:r,roleColumns:n,SearchFormComponent:h,total:c,limit:p,loading:x,isEdit:l,formRef:b,editBuzzersModalOpen:d,setPage:z,setLimit:g,setSelected:S,setEditBuzzersModalOpen:R,onFinish:m}=Y();return e.jsxs(e.Fragment,{children:[h,e.jsx(M,{dataSource:r,loading:x,columns:n,bordered:!0,pagination:!1,rowKey:"buzzerId",rowSelection:{onChange:o=>S(o)}}),e.jsx(T,{total:c,className:"flex justify-end mt-2",pageSize:p,onChange:o=>z(o),showSizeChanger:!0,onShowSizeChange:(o,f)=>g(f)}),e.jsx(F,{open:d,title:l?"编辑":"新增",onOk:m,onCancel:()=>R(!1),children:e.jsxs(j,{form:b,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[l&&e.jsx(j.Item,{name:"buzzerId",label:"蜂鸣器 ID",rules:[{required:!0,message:"请输入蜂鸣器 ID"}],children:e.jsx(A,{style:{width:"100%"},disabled:l})}),e.jsx(j.Item,{name:"buzzerRule",label:"蜂鸣器规则",rules:[{required:!0,message:"请输入蜂鸣器规则"}],children:e.jsx(C,{})})]})})]})},Z=s.memo(G);export{Z as default};
