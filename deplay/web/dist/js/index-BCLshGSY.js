import{r as s,j as e}from"./vendor-react-BvY5jkjb.js";import{e as O,b as w,u as D,c as M,d as T}from"./index-BO69pAs_.js";import{u as A}from"./useSearchForm-DVBHnHbJ.js";import"./vendor-common-DvYBgWFG.js";import{G as L,o as H,H as _,l as C,N as F,O as v,Q as G,F as j,a0 as K}from"./vendor-antd-VwCNQJi5.js";import"./route-login-BWcqE1fc.js";import"./route-layout-33ldzD5l.js";import"./vendor-redux-D__shqzO.js";import"./vendor-router-C3iwmVt3.js";const Q=()=>{const[a]=L(),[n,p]=s.useState(10),[c,h]=s.useState(1),[x,l]=s.useState(0),[g,d]=s.useState(!1),[z,b]=s.useState([]),[S,R]=s.useState([]),[m,o]=s.useState(),[f,I]=s.useState(!1),[B,u]=s.useState(!1),y=[{label:"蜂鸣器规则",name:"buzzerRule",component:e.jsx(C,{allowClear:!0})}],{SearchFormComponent:E}=A({getDataRequestFn:t=>i(t),onNewRecordFn:()=>{I(!1),u(!0),a.resetFields()},formItems:y,operateComponent:!!z.length&&e.jsx(H,{type:"primary",icon:e.jsx(_,{}),onClick:()=>O(z),children:"导出"}),formName:"buzzerSearchForm"}),i=t=>{d(!0),w({limit:n,offset:(c-1)*n,...t}).then(r=>{R(r.data.list),l(r.data.total)}).finally(()=>{d(!1)})},k=t=>{F.confirm({title:"确认删除",content:t.length>1?"确定要删除选中的规则吗？":"确定要删除该规则吗？",okText:"确定",cancelText:"取消",onOk:()=>{T(t).then(()=>i())}})},q=async t=>{o(t),I(!0),u(!0),a.setFieldsValue(t)},P=()=>{a.validateFields().then(t=>{if(f&&m){const r={buzzerId:m.buzzerId,buzzerRule:t.buzzerRule};D(r).then(()=>{u(!1),i()})}else{const r={buzzerRule:t.buzzerRule};M(r).then(()=>{u(!1),i()})}})},N=[{title:"蜂鸣器ID",dataIndex:"buzzerId",key:"buzzerId"},{title:"蜂鸣器规则",dataIndex:"buzzerRule",key:"buzzerRule"},{title:"操作",key:"action",align:"center",render:(t,r)=>e.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[e.jsx("span",{onClick:()=>q(r),children:"编辑"}),e.jsx("span",{className:"text-red-500",onClick:()=>k([r.buzzerId]),children:"删除"})]})}];return s.useEffect(()=>{},[B]),s.useEffect(()=>{i()},[n,c]),{list:S,roleColumns:N,SearchFormComponent:E,total:x,limit:n,loading:g,isEdit:f,formRef:a,editBuzzersModalOpen:B,setPage:h,setLimit:p,setSelected:b,setEditBuzzersModalOpen:u,onFinish:P}},V=()=>{const{list:a,roleColumns:n,SearchFormComponent:p,total:c,limit:h,loading:x,isEdit:l,formRef:g,editBuzzersModalOpen:d,setPage:z,setLimit:b,setSelected:S,setEditBuzzersModalOpen:R,onFinish:m}=Q();return e.jsxs(e.Fragment,{children:[p,e.jsx(v,{dataSource:a,loading:x,columns:n,bordered:!0,pagination:!1,rowKey:"buzzerId",rowSelection:{onChange:o=>S(o)}}),e.jsx(G,{total:c,className:"flex justify-end mt-2",pageSize:h,onChange:o=>z(o),showSizeChanger:!0,onShowSizeChange:(o,f)=>b(f)}),e.jsx(F,{open:d,title:l?"编辑":"新增",onOk:m,onCancel:()=>R(!1),children:e.jsxs(j,{form:g,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[l&&e.jsx(j.Item,{name:"buzzerId",label:"蜂鸣器 ID",rules:[{required:!0,message:"请输入蜂鸣器 ID"}],children:e.jsx(K,{style:{width:"100%"},disabled:l})}),e.jsx(j.Item,{name:"buzzerRule",label:"蜂鸣器规则",rules:[{required:!0,message:"请输入蜂鸣器规则"}],children:e.jsx(C,{})})]})})]})},se=s.memo(V);export{se as default};
