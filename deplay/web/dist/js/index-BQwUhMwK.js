import{r as i,h6 as T,j as e,hb as w,ha as j,l as o,V as u,m as v,I as d}from"./vendor-core-BL9Phd6R.js";import{A as m}from"./route-login-r9SQJoz-.js";import"./route-layout-BrOgEPTf.js";const S=()=>m.get({url:"/timeTask"}),y=t=>m.post({url:`/timeTask/start/${t}`}),I=t=>m.post({url:`/timeTask/stop/${t}`}),b=(t,s)=>m.patch({url:`/timeTask/update/${t}`,data:s}),C="data:image/svg+xml,%3csvg%20t='1715844308979'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='22098'%20width='20'%20height='20'%3e%3cpath%20d='M512%2064a448.128%20448.128%200%200%200%200%20896%20446.976%20446.976%200%200%200%20381.056-212.288c18.56-30.08%200-48.768-30.016-67.392-30.08-18.624-60.16-30.08-78.784%200A318.976%20318.976%200%200%201%20512%20832a320%20320%200%200%201%200-640c35.328%200%2040.448-30.72%2040.448-66.048S547.328%2064%20512%2064z%20m447.68%20469.568c6.784-177.92-84.672-327.616-220.224-407.616-30.464-17.92-47.104%201.92-65.088%2032.384-17.92%2030.4-30.464%2059.904%200%2077.824A319.744%20319.744%200%200%201%20832%20512c0%2035.328%2033.664%2040.576%2061.056%2052.864%2027.328%2012.288%2065.28%203.968%2066.624-31.296z'%20fill='%2300b0f0'%20p-id='22099'%3e%3c/path%3e%3c/svg%3e",A="data:image/svg+xml,%3csvg%20t='1715844308979'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='22098'%20width='20'%20height='20'%3e%3cpath%20d='M512%2064a448.128%20448.128%200%200%200%200%20896%20446.976%20446.976%200%200%200%20381.056-212.288c18.56-30.08%200-48.768-30.016-67.392-30.08-18.624-60.16-30.08-78.784%200A318.976%20318.976%200%200%201%20512%20832a320%20320%200%200%201%200-640c35.328%200%2040.448-30.72%2040.448-66.048S547.328%2064%20512%2064z%20m447.68%20469.568c6.784-177.92-84.672-327.616-220.224-407.616-30.464-17.92-47.104%201.92-65.088%2032.384-17.92%2030.4-30.464%2059.904%200%2077.824A319.744%20319.744%200%200%201%20832%20512c0%2035.328%2033.664%2040.576%2061.056%2052.864%2027.328%2012.288%2065.28%203.968%2066.624-31.296z'%20fill='%238a8a8a'%20p-id='22099'%3e%3c/path%3e%3c/svg%3e";function q(t){const s=Math.floor(t/3600),r=Math.floor(t%3600/60),c=(t%60).toFixed(0);return`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`}const N=()=>{const[t]=T(),[s,r]=i.useState(!1),[c,p]=i.useState(),[h,x]=i.useState([]),l=async()=>{const a=await S();x(a.data)},f=async a=>{await y(a),l().then()},g=async a=>{await I(a),l().then()},k=[{title:"任务名称",dataIndex:"taskName",key:"taskName"},{title:"运行时间",dataIndex:"runTimes",key:"runTimes",align:"center",width:200,render:a=>e.jsx("span",{children:q(a)})},{title:"任务状态",dataIndex:"status",key:"status",align:"center",render:(a,{timeTaskID:n})=>a?e.jsx(d,{src:C,preview:!1,className:"animate-spin cursor-pointer",onClick:()=>g(n)}):e.jsx(d,{src:A,className:"cursor-pointer",preview:!1,onClick:()=>f(n)})},{title:"Cron表达式",dataIndex:"cron",key:"cron",align:"center"},{title:"最后运行时间",dataIndex:"lastRunTime",key:"lastRunTime",align:"center"},{title:"操作",align:"center",width:120,render:(a,n)=>e.jsx("div",{className:"flex justify-center items-center text-[#00b0f0] cursor-pointer",onClick:()=>{r(!0),p(n),t.setFieldsValue(n)},children:"编辑"})}];return i.useEffect(()=>{l().then()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3 flex justify-between items-center app-card-flat p-4",children:e.jsx("span",{className:"font-bold",children:"定时任务"})}),e.jsx(w,{dataSource:h,rowKey:"timeTaskID",columns:k}),e.jsx(j,{open:s,onCancel:()=>r(!1),title:"编辑",onOk:()=>{t.validateFields().then(async a=>{try{if(!c?.timeTaskID)return;await b(c?.timeTaskID,a)}finally{r(!1),await l()}})},children:e.jsxs(o,{form:t,autoComplete:"off",labelCol:{span:6},wrapperCol:{span:16},labelAlign:"left",children:[e.jsx(o.Item,{label:"任务名称",name:"taskName",rules:[{required:!0}],children:e.jsx(u,{})}),e.jsx(o.Item,{label:"Cron表达式",name:"cron",rules:[{required:!0}],children:e.jsx(u,{})}),e.jsx(o.Item,{label:"任务状态",name:"status",rules:[{required:!0}],children:e.jsx(v,{})})]})})]})},$=i.memo(N);export{$ as default};
