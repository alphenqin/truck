import{r as s,j as t}from"./vendor-react-BvY5jkjb.js";import{A as c}from"./route-login-BWcqE1fc.js";import{u as M}from"./useSearchForm-DVBHnHbJ.js";import"./vendor-common-DvYBgWFG.js";import{G as T,o as A,H as z,l as h,N as E,O as H,Q as _,F as y}from"./vendor-antd-VwCNQJi5.js";import"./route-layout-33ldzD5l.js";import"./vendor-redux-D__shqzO.js";import"./vendor-router-C3iwmVt3.js";const B=n=>c.post({url:"/base/line/query",data:n}),G=n=>c.post({url:"/base/line",data:n}),K=(n,a)=>c.patch({url:"/base/line/update",data:{...a,lineId:n}}),Q=n=>c.delete({url:"/base/line/batch-delete",data:n}),V=n=>c.post({url:"/base/line/export",data:{ids:n},responseType:"blob"}),J=()=>{const[n]=T(),[a,I]=s.useState(10),[m,g]=s.useState(1),[b,u]=s.useState(0),[S,p]=s.useState(!1),[f,j]=s.useState([]),[L,C]=s.useState([]),[x,o]=s.useState(),[l,N]=s.useState(!1),[F,r]=s.useState(!1),k=[{label:"线路ID",name:"lineId",component:t.jsx(h,{type:"number",allowClear:!0,min:1})},{label:"线路名称",name:"lineName",component:t.jsx(h,{allowClear:!0})}],{SearchFormComponent:q}=M({getDataRequestFn:e=>{e.lineId===""||e.lineId===void 0||e.lineId===null?delete e.lineId:e.lineId=Number(e.lineId),d(e)},onNewRecordFn:()=>{N(!1),r(!0),n.resetFields()},formItems:k,operateComponent:!!f.length&&t.jsx(A,{type:"primary",icon:t.jsx(z,{}),onClick:()=>V(f.map(e=>Number(e))),children:"导出"}),formName:"lineSearchForm"}),d=e=>{p(!0);const i={limit:a,offset:(m-1)*a,...e};i.lineId&&(i.lineId=Number(i.lineId)),B(i).then(R=>{C(R.data.list),u(R.data.total)}).finally(()=>{p(!1)})},w=e=>{E.confirm({title:"确认删除",content:"确定要删除这条线路吗？",okText:"确认",cancelText:"取消",onOk:()=>{Q([e]).then(()=>d())}})},O=async e=>{o(e),N(!0),r(!0)},D=()=>{n.validateFields().then(e=>{l?K(x.lineId,e).then(()=>{r(!1),d()}):G(e).then(()=>{r(!1),d()})})},P=[{title:"线路ID",dataIndex:"lineId",key:"lineId"},{title:"线路名称",dataIndex:"lineName",key:"lineName"},{title:"操作",key:"action",align:"center",render:(e,i)=>t.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[t.jsx("span",{onClick:()=>O(i),children:"编辑"}),t.jsx("span",{className:"text-red-500",onClick:()=>w(i.lineId),children:"删除"})]})}];return s.useEffect(()=>{F&&l&&n.setFieldsValue(x)},[F]),s.useEffect(()=>{d()},[a,m]),{list:L,roleColumns:P,SearchFormComponent:q,total:b,limit:a,loading:S,isEdit:l,formRef:n,editLinesModalOpen:F,setPage:g,setLimit:I,setSelected:j,setEditLinesModalOpen:r,onFinish:D}},U=()=>{const{list:n,roleColumns:a,SearchFormComponent:I,total:m,limit:g,loading:b,isEdit:u,formRef:S,editLinesModalOpen:p,setPage:f,setLimit:j,setSelected:L,setEditLinesModalOpen:C,onFinish:x}=J();return t.jsxs(t.Fragment,{children:[I,t.jsx(H,{dataSource:n,rowSelection:{onChange:o=>{L(o)}},loading:b,columns:a,bordered:!0,pagination:!1,rowKey:"lineId"}),t.jsx(_,{total:m,className:"flex justify-end mt-2",pageSize:g,onChange:o=>f(o),showSizeChanger:!0,onShowSizeChange:(o,l)=>j(l)}),t.jsx(E,{open:p,title:u?"编辑":"新增",onOk:x,onCancel:()=>C(!1),children:t.jsxs(y,{form:S,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[u&&t.jsx(y.Item,{name:"lineId",label:"线路ID",rules:[{required:!0,message:"请输入线路ID"}],children:t.jsx(h,{type:"number",disabled:!0,min:1})}),t.jsx(y.Item,{name:"lineName",label:"线路名称",rules:[{required:!0,message:"请输入线路名称"}],children:t.jsx(h,{})})]})})]})},ne=s.memo(U);export{ne as default};
