import{r as s,j as e}from"./vendor-react-BvY5jkjb.js";import{A as m}from"./route-login-BWcqE1fc.js";import{u as M}from"./useSearchForm-DVBHnHbJ.js";import"./vendor-common-DvYBgWFG.js";import{G as T,o as z,H as D,l as i,N as q,O as L,Q as H,F as x}from"./vendor-antd-VwCNQJi5.js";import"./route-layout-33ldzD5l.js";import"./vendor-redux-D__shqzO.js";import"./vendor-router-C3iwmVt3.js";const _=t=>m.post({url:"/base/arg/query",data:t}),v=t=>m.post({url:"/base/arg",data:t}),B=(t,r)=>m.patch({url:`/base/arg/update/${t}`,data:r}),G=t=>m.delete({url:"/base/arg/batch-delete",data:t}),Q=t=>m.post({url:"/base/arg/export",data:{ids:t},responseType:"blob"}),U=()=>{const[t]=T(),[r,h]=s.useState(10),[g,j]=s.useState(1),[b,S]=s.useState(0),[A,p]=s.useState(!1),[f,C]=s.useState([]),[y,F]=s.useState([]),[o,l]=s.useState(),[d,R]=s.useState(!1),[I,c]=s.useState(!1),E=[{label:"参数键",name:"argKey",component:e.jsx(i,{allowClear:!0})},{label:"参数名称",name:"argName",component:e.jsx(i,{allowClear:!0})},{label:"参数值",name:"argValue",component:e.jsx(i,{allowClear:!0})}],{SearchFormComponent:N}=M({getDataRequestFn:a=>u(a),onNewRecordFn:()=>{t.resetFields(),R(!1),c(!0)},formItems:E,operateComponent:!!f.length&&e.jsx(z,{type:"primary",icon:e.jsx(D,{}),onClick:()=>Q(f.map(Number)),children:"导出"}),formName:"roleSearchUserForm"}),u=a=>{p(!0),_({limit:r,offset:(g-1)*r,...a}).then(n=>{const K=n.data.list.map(k=>({...k,id:k.id??k.argId}));F(K),S(n.data.total)}).finally(()=>{p(!1)})},w=a=>{q.confirm({title:"确认删除",content:"确定要删除该参数吗？",okText:"确认",cancelText:"取消",onOk:()=>{G([a]).then(()=>u())}})},O=async a=>{l(a),R(!0),c(!0)},P=()=>{t.validateFields().then(a=>{if(d&&o){const n={...a,id:o.id};B(o.id,n).then(()=>{c(!1),u()})}else v(a).then(()=>{c(!1),u()})})},V=[{title:"ID",dataIndex:"id",key:"id"},{title:"参数键",dataIndex:"argKey",key:"argKey"},{title:"参数名称",dataIndex:"argName",key:"argName"},{title:"参数值",dataIndex:"argValue",key:"argValue"},{title:"操作",key:"action",align:"center",render:(a,n)=>e.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[e.jsx("span",{onClick:()=>O(n),children:"编辑"}),e.jsx("span",{className:"text-red-500",onClick:()=>w(n.id),children:"删除"})]})}];return s.useEffect(()=>{I&&d&&t.setFieldsValue(o)},[I]),s.useEffect(()=>{u()},[r,g]),{list:y,roleColumns:V,SearchFormComponent:N,total:b,limit:r,loading:A,isEdit:d,formRef:t,editArgsModalOpen:I,setPage:j,setLimit:h,setSelected:C,setEditArgsModalOpen:c,onFinish:P}},W=()=>{const{list:t,roleColumns:r,SearchFormComponent:h,total:g,limit:j,loading:b,isEdit:S,formRef:A,editArgsModalOpen:p,setPage:f,setLimit:C,setSelected:y,setEditArgsModalOpen:F,onFinish:o}=U();return e.jsxs(e.Fragment,{children:[h,e.jsx(L,{dataSource:t,rowSelection:{onChange:l=>{y(l)}},loading:b,columns:r,bordered:!0,pagination:!1,rowKey:"id"}),e.jsx(H,{total:g,className:"flex justify-end mt-2",pageSize:j,onChange:l=>f(l),showSizeChanger:!0,onShowSizeChange:(l,d)=>C(d)}),e.jsx(q,{open:p,title:S?"编辑":"新增",onOk:o,onCancel:()=>F(!1),children:e.jsxs(x,{form:A,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[e.jsx(x.Item,{name:"argKey",label:"参数键",rules:[{required:!0}],children:e.jsx(i,{})}),e.jsx(x.Item,{name:"argName",label:"参数名称",rules:[{required:!0}],children:e.jsx(i,{})}),e.jsx(x.Item,{name:"argValue",label:"参数值",rules:[{required:!0}],children:e.jsx(i,{})})]})})]})},ae=s.memo(W);export{ae as default};
