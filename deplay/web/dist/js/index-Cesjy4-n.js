import{h6 as T,r as s,j as t,Y as A,h7 as z,V as k,ha as E,Z as D,hb as L,hc as V,l as b}from"./vendor-core-BL9Phd6R.js";import{A as c}from"./route-login-r9SQJoz-.js";import{u as _}from"./useSearchForm-DGLxIQDe.js";import"./route-layout-BrOgEPTf.js";const v=e=>c.post({url:"/sl/garden/query",data:e}),B=e=>c.post({url:"/sl/garden",data:e}),H=e=>c.delete({url:"/sl/garden/batch-delete",data:e}),K=e=>c.patch({url:"/sl/garden/update",data:e}),U=e=>c.post({url:"/sl/garden/export",data:{ids:e},responseType:"blob"}),Y=()=>{const[e]=T(),[n,p]=s.useState(10),[u,h]=s.useState(1),[x,S]=s.useState(0),[j,g]=s.useState(!1),[m,C]=s.useState([]),[F,y]=s.useState([]),[f,r]=s.useState(),[l,R]=s.useState(!1),[I,d]=s.useState(!1),q=[{label:"园区名称",name:"gardenName",component:t.jsx(k,{allowClear:!0})}],{SearchFormComponent:N}=_({getDataRequestFn:a=>i(a),onNewRecordFn:()=>{R(!1),e.resetFields(),d(!0)},formItems:q,operateComponent:!!m.length&&t.jsx(A,{type:"primary",icon:t.jsx(z,{}),onClick:()=>U(m),children:"导出"}),formName:"roleSearchUserForm"}),i=a=>{g(!0),v({limit:n,offset:(u-1)*n,...a}).then(o=>{console.log(o),y(o.data.list),S(o.data.total)}).finally(()=>{g(!1)})},w=a=>{E.confirm({title:"确认删除",content:"确定要删除该园区吗？",okText:"删除",okType:"danger",cancelText:"取消",onOk:()=>{H([a]).then(()=>{D.success("删除成功"),i()})}})},M=async a=>{r(a),R(!0),d(!0)},O=()=>{e.validateFields().then(a=>{l?K({...f,...a}).then(()=>{d(!1),i()}):B(a).then(()=>{d(!1),i()})})},P=[{title:"园区ID",dataIndex:"gardenId",key:"gardenId",align:"center"},{title:"园区名称",dataIndex:"gardenName",key:"gardenName"},{title:"操作",key:"action",align:"center",render:(a,o)=>t.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[t.jsx("span",{onClick:()=>M(o),children:"编辑"}),t.jsx("span",{className:"text-red-500",onClick:()=>w(o.gardenId),children:"删除"})]})}];return s.useEffect(()=>{I&&l&&e.setFieldsValue(f)},[I]),s.useEffect(()=>{i()},[n,u]),{list:F,roleColumns:P,SearchFormComponent:N,total:x,limit:n,loading:j,isEdit:l,formRef:e,editgarendsModalOpen:I,setPage:h,setLimit:p,setSelected:C,setEditgarendsModalOpen:d,onFinish:O}},Z=()=>{const{list:e,roleColumns:n,SearchFormComponent:p,total:u,limit:h,loading:x,isEdit:S,formRef:j,editgarendsModalOpen:g,setPage:m,setLimit:C,setSelected:F,setEditgarendsModalOpen:y,onFinish:f}=Y();return t.jsxs(t.Fragment,{children:[p,t.jsx(L,{dataSource:e,rowSelection:{onChange:r=>{F(r)}},loading:x,columns:n,bordered:!0,pagination:!1,rowKey:"gardenId"}),t.jsx(V,{total:u,className:"flex justify-end mt-2",pageSize:h,onChange:r=>m(r),showSizeChanger:!0,onShowSizeChange:(r,l)=>C(l)}),t.jsx(E,{open:g,title:S?"编辑":"新增",onOk:f,onCancel:()=>y(!1),children:t.jsx(b,{form:j,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:t.jsx(b.Item,{name:"gardenName",label:"园区名称",rules:[{required:!0}],children:t.jsx(k,{})})})})]})},X=s.memo(Z);export{X as default};
