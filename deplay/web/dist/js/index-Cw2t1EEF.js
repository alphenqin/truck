import{r as a,j as t}from"./vendor-react-BvY5jkjb.js";import{A as d}from"./route-login-BWcqE1fc.js";import{u as P}from"./useSearchForm-DVBHnHbJ.js";import"./vendor-common-DvYBgWFG.js";import{G as M,o as z,H as L,l as x,N as R,O as H,Q as _,F as C}from"./vendor-antd-VwCNQJi5.js";import"./route-layout-33ldzD5l.js";import"./vendor-redux-D__shqzO.js";import"./vendor-router-C3iwmVt3.js";const B=e=>d.post({url:"/base/type/query",data:e}),G=e=>d.post({url:"/base/type",data:e}),K=(e,o)=>d.patch({url:"/base/type/update",data:{...o,typeId:e}}),Q=e=>d.delete({url:"/base/type/batch-delete",data:e}),U=e=>d.post({url:"/base/type/export",data:{ids:e},responseType:"blob"}),V=()=>{const[e]=M(),[o,h]=a.useState(10),[c,g]=a.useState(1),[I,m]=a.useState(0),[b,u]=a.useState(!1),[y,S]=a.useState([]),[T,j]=a.useState([]),[f,r]=a.useState(),[l,F]=a.useState(!1),[A,i]=a.useState(!1),E=[{label:"类型ID",name:"typeId",component:t.jsx(x,{type:"number",allowClear:!0,min:1})},{label:"类型名称",name:"typeName",component:t.jsx(x,{allowClear:!0})}],{SearchFormComponent:k}=P({getDataRequestFn:s=>p(s),onNewRecordFn:()=>{F(!1),i(!0),e.resetFields()},formItems:E,operateComponent:!!y.length&&t.jsx(z,{type:"primary",icon:t.jsx(L,{}),onClick:()=>U(y.map(s=>Number(s))),children:"导出"}),formName:"roleSearchUserForm"}),p=s=>{u(!0);const n={limit:o,offset:(c-1)*o,...s};n.typeId&&(n.typeId=Number(n.typeId)),B(n).then(N=>{j(N.data.list),m(N.data.total)}).finally(()=>{u(!1)})},q=s=>{R.confirm({title:"确认删除",content:"确定要删除该资产类型吗？",okText:"确定",cancelText:"取消",onOk:()=>{Q([s]).then(()=>p())}})},w=async s=>{r(s),F(!0),i(!0)},D=()=>{e.validateFields().then(s=>{if(l)K(f.typeId,s).then(()=>{i(!1),p()});else{if(!s.typeId){e.setFields([{name:"typeId",errors:["请输入类型ID"]}]);return}const n={...s,typeId:Number(s.typeId)};G(n).then(()=>{i(!1),p()})}})},O=[{title:"类型ID",dataIndex:"typeId",key:"typeId"},{title:"类型名称",dataIndex:"typeName",key:"typeName"},{title:"操作",key:"action",align:"center",render:(s,n)=>t.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[t.jsx("span",{onClick:()=>w(n),children:"编辑"}),t.jsx("span",{className:"text-red-500",onClick:()=>q(n.typeId),children:"删除"})]})}];return a.useEffect(()=>{A&&l&&e.setFieldsValue(f)},[A]),a.useEffect(()=>{p()},[o,c]),{list:T,roleColumns:O,SearchFormComponent:k,total:I,limit:o,loading:b,isEdit:l,formRef:e,editAssetTypesModalOpen:A,setPage:g,setLimit:h,setSelected:S,setEditAssetTypesModalOpen:i,onFinish:D}},J=()=>{const{list:e,roleColumns:o,SearchFormComponent:h,total:c,limit:g,loading:I,isEdit:m,formRef:b,editAssetTypesModalOpen:u,setPage:y,setLimit:S,setSelected:T,setEditAssetTypesModalOpen:j,onFinish:f}=V();return t.jsxs(t.Fragment,{children:[h,t.jsx(H,{dataSource:e,rowSelection:{onChange:r=>{T(r)}},loading:I,columns:o,bordered:!0,pagination:!1,rowKey:"typeId"}),t.jsx(_,{total:c,className:"flex justify-end mt-2",pageSize:g,onChange:r=>y(r),showSizeChanger:!0,onShowSizeChange:(r,l)=>S(l)}),t.jsx(R,{open:u,title:m?"编辑":"新增",onOk:f,onCancel:()=>j(!1),children:t.jsxs(C,{form:b,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[t.jsx(C.Item,{name:"typeId",label:"类型ID",rules:[{required:!0,message:"请输入类型ID"}],children:t.jsx(x,{type:"number",disabled:m,min:1})}),t.jsx(C.Item,{name:"typeName",label:"类型名称",rules:[{required:!0,message:"请输入类型名称"}],children:t.jsx(x,{})})]})})]})},se=a.memo(J);export{se as default};
