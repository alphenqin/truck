import{t as A,r as l,gU as w,j as e,y as k,h1 as I,K as L,h2 as C,h3 as p,q as d,h4 as R,h5 as T}from"./vendor-core-BL9Phd6R.js";import{E as h}from"./vendor-echarts-DVuAcVfv.js";import{g as $,M as D,a as P,b as q}from"./route-login-p179xrQD.js";import{h as N,n as Y,I as F}from"./route-layout-De7MC9tK.js";const G={title:{text:"内存占用",left:"50%",top:"0",textAlign:"center",textStyle:{fontSize:"12"}},grid:{bottom:"20%",top:"10%",left:"3%",right:"3%"},tooltip:{trigger:"axis",formatter(t){return`
          ${t[0].marker} 总内存：${(t[0].data/(1024*1024*1024)).toFixed(2)}GB<br/>
          ${t[0].marker} 已使用内存：${(t[1].data/(1024*1024*1024)).toFixed(2)}GB<br/>
        `}},xAxis:{type:"category",axisLabel:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{show:!1},axisLine:{show:!0},axisTick:{show:!1}},animation:!0},E={animation:!0,animationDuration:3e3,animationEasing:"bounceOut",animationThreshold:8,title:{text:"CPU使用率",textStyle:{fontSize:13},left:"50%",textAlign:"center"},tooltip:{trigger:"axis",formatter(t){return`${t[0].marker}CPU使用率  ${t[0].data.toFixed(2)}%`}},grid:{bottom:"20%",top:"10%",left:"3%",right:"3%"},xAxis:{type:"category",axisLabel:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{show:!1},axisTick:{show:!1}}},z={tooltip:{trigger:"item",formatter(t){return`${t.marker} ${t.name} ${t.percent}%`}},grid:{bottom:"20%",top:"10%",left:"3%",right:"3%"}},H={tooltip:{trigger:"item"},calendar:{top:120,left:30,right:30,cellSize:["auto",13],range:"2024",splitLine:{show:!1},itemStyle:{borderWidth:.5},dayLabel:{nameMap:"ZH"},monthLabel:{nameMap:"ZH"},yearLabel:{show:!1}},visualMap:{type:"piecewise",pieces:[{value:0,color:"#e8eaee"},{min:1,max:3,color:"#8ce4a2"},{min:4,max:6,color:"#2dbb60"},{min:7,max:20,color:"#186235"}],orient:"horizontal",left:"center",top:65,min:1,max:20}},B=()=>{const t=A(),[n,x]=l.useState({}),[g,f]=l.useState({}),[u,b]=l.useState({}),[c,y]=l.useState([]),[j,r]=l.useState(0),[m,v]=l.useState({}),S=l.useRef(null),[a,s]=l.useState(!1),U=()=>{$().then(o=>{x({...G,series:[{name:"总内存",type:"line",showSymbol:!1,data:o.data?.map(i=>i.memUsage.total),color:"gray",lineStyle:{width:1}},{name:"已使用内存",type:"line",showSymbol:!1,data:o.data?.map(i=>i.memUsage.used),lineStyle:{color:"#04a8fb80"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#04a8fb80"},{offset:1,color:"#04a8fb00"}]}}}]}),f({...E,series:[{name:"CPU",type:"line",smooth:!0,showSymbol:!1,data:o.data?.map(i=>i.cpuUsage)}]}),b({...z,series:[{name:"系统运行总情况",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,padAngle:5,itemStyle:{borderRadius:10},label:{show:!0},emphasis:{label:{show:!0,fontSize:10,fontWeight:"bold"}},labelLine:{show:!1},data:D?.map(({label:i,key:O})=>({name:i,value:o.data[0].memUsage[O]||0}))}]})})},M=()=>{s(!0),P().then(o=>{y(o.data),v({...H,series:{type:"heatmap",coordinateSystem:"calendar",data:o.data?.map(i=>[w(i.date).format("YYYY-MM-DD"),i.children.length])}})}).finally(()=>{s(!1)}),q().then(o=>{r(o.data)}).finally(()=>{s(!1)})};return l.useEffect(()=>(U(),M(),()=>{}),[]),{loading:a,gitCommitFrequency:m,gitCommitsRef:S,commitCount:j,gitCommits:c,totalOption:n,cpuUsageOption:g,allMenUsageOption:u,navigateToPage:o=>{t(o.pagePath)}}},W=()=>{const{menus:t}=N(a=>a.UserStore),{themeMode:n}=N(a=>a.UIStore),{loading:x,totalOption:g,cpuUsageOption:f,allMenUsageOption:u,gitCommits:b,commitCount:c,gitCommitFrequency:y,navigateToPage:j}=B(),r="app-card p-5 no-scrollbar w-full",m=[{bg:"rgba(59, 130, 246, 0.12)",color:"#3b82f6"},{bg:"rgba(16, 185, 129, 0.12)",color:"#10b981"},{bg:"rgba(168, 85, 247, 0.12)",color:"#a855f7"},{bg:"rgba(245, 158, 11, 0.12)",color:"#f59e0b"}],v=[{chart:e.jsx(h,{option:g,theme:n,style:{height:"120px",width:"100%"}})},{chart:e.jsx(h,{option:f,theme:n,style:{height:"120px",width:"100%"}})},{chart:e.jsx(h,{option:u,theme:n,style:{height:"120px",width:"100%"}})},{chart:e.jsxs("div",{className:"flex h-[120px] justify-center items-center gap-3",children:[e.jsx("span",{className:"text-5xl font-bold bg-gradient-to-r from-rose-500 to-pink-500 bg-clip-text text-transparent",children:c}),e.jsx("span",{className:"text-[var(--app-muted)] text-lg",children:"提交次数"})]})}],S=b.map(a=>({color:"var(--app-accent)",dot:e.jsx(I,{className:"text-[var(--app-accent)]"}),label:e.jsx("span",{className:"text-[var(--app-accent)] font-medium",children:a.date}),children:a.children.map(s=>e.jsx("div",{className:"cursor-pointer",children:e.jsx(k,{placement:"bottom",arrow:!1,content:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{className:"text-[var(--app-muted)]",children:["作者：",s.author]}),e.jsxs("p",{className:"text-[var(--app-muted)]",children:["时间：",w(s.date).format("YYYY-MM-DD HH:mm:ss")]})]}),children:e.jsx("p",{className:"hover:text-[var(--app-accent)] tran-fast",children:s.message})})},s.commitID))}));return e.jsx(L,{spinning:x,children:e.jsxs(C,{gutter:[16,16],children:[v.map((a,s)=>e.jsx(p,{xs:24,sm:24,md:12,lg:12,xl:6,children:e.jsx("div",{className:d(r,"h-full hover-lift"),style:{animationDelay:`${s*.1}s`},children:a.chart})},s)),e.jsx(p,{xs:24,sm:24,md:24,lg:12,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:d(r),children:[e.jsx("h3",{className:"app-section-title mb-4",children:"快捷入口"}),e.jsx(C,{gutter:[12,12],className:"min-h-[120px]",children:Y(t)?.slice(0,4)?.map((a,s)=>e.jsx(p,{xs:12,sm:6,md:6,lg:12,xl:6,children:e.jsxs("div",{onClick:()=>j(a),className:"flex flex-col justify-center items-center h-24 rounded-xl cursor-pointer tran hover-lift press-scale",style:{background:m[s]?.bg},children:[e.jsx(F,{name:a.pageIcon,props:{className:"text-2xl mb-2",style:{color:m[s]?.color}}}),e.jsx("span",{className:"text-sm font-medium text-[var(--app-text)]",children:a.pageName})]})},a.pageID))})]}),e.jsxs("div",{className:d(r),children:[e.jsxs("h3",{className:"app-section-title mb-2",children:[e.jsx("span",{className:"text-[var(--app-accent)] mr-2",children:c}),"最近一年贡献"]}),e.jsx(h,{option:y,theme:n,style:{width:"100%",height:"250px"}})]})]})}),e.jsx(p,{xs:24,sm:24,md:24,lg:12,children:e.jsxs("div",{className:d(r,"overflow-auto no-scrollbar h-[515px]"),children:[e.jsx("h3",{className:"app-section-title mb-4",children:"更新日志"}),e.jsx(R,{items:S,mode:"alternate",pending:e.jsxs("div",{className:"text-[var(--app-accent)] gap-2 flex items-center",children:[e.jsx(T,{className:"animate-pulse"}),e.jsx("span",{children:"Coding..."})]}),reverse:!0})]})})]})})},X=l.memo(W);export{X as default};
