import{r as s,j as t}from"./vendor-react-BvY5jkjb.js";import{A as c}from"./route-login-BWcqE1fc.js";import{u as T}from"./useSearchForm-DVBHnHbJ.js";import"./vendor-common-DvYBgWFG.js";import{G as A,o as z,H as D,l as E,N as b,s as L,O as H,Q as _,F as k}from"./vendor-antd-VwCNQJi5.js";import"./route-layout-33ldzD5l.js";import"./vendor-redux-D__shqzO.js";import"./vendor-router-C3iwmVt3.js";const v=e=>c.post({url:"/sl/garden/query",data:e}),B=e=>c.post({url:"/sl/garden",data:e}),G=e=>c.delete({url:"/sl/garden/batch-delete",data:e}),K=e=>c.patch({url:"/sl/garden/update",data:e}),Q=e=>c.post({url:"/sl/garden/export",data:{ids:e},responseType:"blob"}),U=()=>{const[e]=A(),[n,f]=s.useState(10),[u,h]=s.useState(1),[x,S]=s.useState(0),[j,g]=s.useState(!1),[m,C]=s.useState([]),[F,y]=s.useState([]),[p,r]=s.useState(),[l,R]=s.useState(!1),[I,d]=s.useState(!1),N=[{label:"园区名称",name:"gardenName",component:t.jsx(E,{allowClear:!0})}],{SearchFormComponent:q}=T({getDataRequestFn:a=>i(a),onNewRecordFn:()=>{R(!1),e.resetFields(),d(!0)},formItems:N,operateComponent:!!m.length&&t.jsx(z,{type:"primary",icon:t.jsx(D,{}),onClick:()=>Q(m),children:"导出"}),formName:"roleSearchUserForm"}),i=a=>{g(!0),v({limit:n,offset:(u-1)*n,...a}).then(o=>{console.log(o),y(o.data.list),S(o.data.total)}).finally(()=>{g(!1)})},O=a=>{b.confirm({title:"确认删除",content:"确定要删除该园区吗？",okText:"删除",okType:"danger",cancelText:"取消",onOk:()=>{G([a]).then(()=>{L.success("删除成功"),i()})}})},w=async a=>{r(a),R(!0),d(!0)},M=()=>{e.validateFields().then(a=>{l?K({...p,...a}).then(()=>{d(!1),i()}):B(a).then(()=>{d(!1),i()})})},P=[{title:"园区ID",dataIndex:"gardenId",key:"gardenId",align:"center"},{title:"园区名称",dataIndex:"gardenName",key:"gardenName"},{title:"操作",key:"action",align:"center",render:(a,o)=>t.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[t.jsx("span",{onClick:()=>w(o),children:"编辑"}),t.jsx("span",{className:"text-red-500",onClick:()=>O(o.gardenId),children:"删除"})]})}];return s.useEffect(()=>{I&&l&&e.setFieldsValue(p)},[I]),s.useEffect(()=>{i()},[n,u]),{list:F,roleColumns:P,SearchFormComponent:q,total:x,limit:n,loading:j,isEdit:l,formRef:e,editgarendsModalOpen:I,setPage:h,setLimit:f,setSelected:C,setEditgarendsModalOpen:d,onFinish:M}},V=()=>{const{list:e,roleColumns:n,SearchFormComponent:f,total:u,limit:h,loading:x,isEdit:S,formRef:j,editgarendsModalOpen:g,setPage:m,setLimit:C,setSelected:F,setEditgarendsModalOpen:y,onFinish:p}=U();return t.jsxs(t.Fragment,{children:[f,t.jsx(H,{dataSource:e,rowSelection:{onChange:r=>{F(r)}},loading:x,columns:n,bordered:!0,pagination:!1,rowKey:"gardenId"}),t.jsx(_,{total:u,className:"flex justify-end mt-2",pageSize:h,onChange:r=>m(r),showSizeChanger:!0,onShowSizeChange:(r,l)=>C(l)}),t.jsx(b,{open:g,title:S?"编辑":"新增",onOk:p,onCancel:()=>y(!1),children:t.jsx(k,{form:j,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:t.jsx(k.Item,{name:"gardenName",label:"园区名称",rules:[{required:!0}],children:t.jsx(E,{})})})})]})},se=s.memo(V);export{se as default};
