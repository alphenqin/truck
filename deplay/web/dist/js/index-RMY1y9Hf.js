import{h6 as M,r as s,j as t,Y as T,h7 as A,V as x,ha as E,hb as z,hc as V,l as y}from"./vendor-core-BL9Phd6R.js";import{A as c}from"./route-login-r9SQJoz-.js";import{u as _}from"./useSearchForm-DGLxIQDe.js";import"./route-layout-BrOgEPTf.js";const B=n=>c.post({url:"/base/line/query",data:n}),H=n=>c.post({url:"/base/line",data:n}),K=(n,a)=>c.patch({url:"/base/line/update",data:{...a,lineId:n}}),Y=n=>c.delete({url:"/base/line/batch-delete",data:n}),G=n=>c.post({url:"/base/line/export",data:{ids:n},responseType:"blob"}),J=()=>{const[n]=M(),[a,I]=s.useState(10),[u,g]=s.useState(1),[b,m]=s.useState(0),[S,f]=s.useState(!1),[p,j]=s.useState([]),[L,C]=s.useState([]),[h,o]=s.useState(),[l,N]=s.useState(!1),[F,r]=s.useState(!1),k=[{label:"线路ID",name:"lineId",component:t.jsx(x,{type:"number",allowClear:!0,min:1})},{label:"线路名称",name:"lineName",component:t.jsx(x,{allowClear:!0})}],{SearchFormComponent:q}=_({getDataRequestFn:e=>{e.lineId===""||e.lineId===void 0||e.lineId===null?delete e.lineId:e.lineId=Number(e.lineId),d(e)},onNewRecordFn:()=>{N(!1),r(!0),n.resetFields()},formItems:k,operateComponent:!!p.length&&t.jsx(T,{type:"primary",icon:t.jsx(A,{}),onClick:()=>G(p.map(e=>Number(e))),children:"导出"}),formName:"lineSearchForm"}),d=e=>{f(!0);const i={limit:a,offset:(u-1)*a,...e};i.lineId&&(i.lineId=Number(i.lineId)),B(i).then(R=>{C(R.data.list),m(R.data.total)}).finally(()=>{f(!1)})},w=e=>{E.confirm({title:"确认删除",content:"确定要删除这条线路吗？",okText:"确认",cancelText:"取消",onOk:()=>{Y([e]).then(()=>d())}})},D=async e=>{o(e),N(!0),r(!0)},O=()=>{n.validateFields().then(e=>{l?K(h.lineId,e).then(()=>{r(!1),d()}):H(e).then(()=>{r(!1),d()})})},P=[{title:"线路ID",dataIndex:"lineId",key:"lineId"},{title:"线路名称",dataIndex:"lineName",key:"lineName"},{title:"操作",key:"action",align:"center",render:(e,i)=>t.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[t.jsx("span",{onClick:()=>D(i),children:"编辑"}),t.jsx("span",{className:"text-red-500",onClick:()=>w(i.lineId),children:"删除"})]})}];return s.useEffect(()=>{F&&l&&n.setFieldsValue(h)},[F]),s.useEffect(()=>{d()},[a,u]),{list:L,roleColumns:P,SearchFormComponent:q,total:b,limit:a,loading:S,isEdit:l,formRef:n,editLinesModalOpen:F,setPage:g,setLimit:I,setSelected:j,setEditLinesModalOpen:r,onFinish:O}},Q=()=>{const{list:n,roleColumns:a,SearchFormComponent:I,total:u,limit:g,loading:b,isEdit:m,formRef:S,editLinesModalOpen:f,setPage:p,setLimit:j,setSelected:L,setEditLinesModalOpen:C,onFinish:h}=J();return t.jsxs(t.Fragment,{children:[I,t.jsx(z,{dataSource:n,rowSelection:{onChange:o=>{L(o)}},loading:b,columns:a,bordered:!0,pagination:!1,rowKey:"lineId"}),t.jsx(V,{total:u,className:"flex justify-end mt-2",pageSize:g,onChange:o=>p(o),showSizeChanger:!0,onShowSizeChange:(o,l)=>j(l)}),t.jsx(E,{open:f,title:m?"编辑":"新增",onOk:h,onCancel:()=>C(!1),children:t.jsxs(y,{form:S,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[m&&t.jsx(y.Item,{name:"lineId",label:"线路ID",rules:[{required:!0,message:"请输入线路ID"}],children:t.jsx(x,{type:"number",disabled:!0,min:1})}),t.jsx(y.Item,{name:"lineName",label:"线路名称",rules:[{required:!0,message:"请输入线路名称"}],children:t.jsx(x,{})})]})})]})},$=s.memo(Q);export{$ as default};
