import{h6 as P,r as a,j as t,Y as M,h7 as z,V as h,ha as R,hb as L,hc as V,l as C}from"./vendor-core-BL9Phd6R.js";import{A as p}from"./route-login-r9SQJoz-.js";import{u as _}from"./useSearchForm-DGLxIQDe.js";import"./route-layout-BrOgEPTf.js";const B=e=>p.post({url:"/base/type/query",data:e}),H=e=>p.post({url:"/base/type",data:e}),K=(e,o)=>p.patch({url:"/base/type/update",data:{...o,typeId:e}}),U=e=>p.delete({url:"/base/type/batch-delete",data:e}),Y=e=>p.post({url:"/base/type/export",data:{ids:e},responseType:"blob"}),G=()=>{const[e]=P(),[o,x]=a.useState(10),[c,g]=a.useState(1),[I,u]=a.useState(0),[b,m]=a.useState(!1),[y,S]=a.useState([]),[T,j]=a.useState([]),[f,r]=a.useState(),[l,F]=a.useState(!1),[A,i]=a.useState(!1),E=[{label:"类型ID",name:"typeId",component:t.jsx(h,{type:"number",allowClear:!0,min:1})},{label:"类型名称",name:"typeName",component:t.jsx(h,{allowClear:!0})}],{SearchFormComponent:k}=_({getDataRequestFn:s=>d(s),onNewRecordFn:()=>{F(!1),i(!0),e.resetFields()},formItems:E,operateComponent:!!y.length&&t.jsx(M,{type:"primary",icon:t.jsx(z,{}),onClick:()=>Y(y.map(s=>Number(s))),children:"导出"}),formName:"roleSearchUserForm"}),d=s=>{m(!0);const n={limit:o,offset:(c-1)*o,...s};n.typeId&&(n.typeId=Number(n.typeId)),B(n).then(N=>{j(N.data.list),u(N.data.total)}).finally(()=>{m(!1)})},q=s=>{R.confirm({title:"确认删除",content:"确定要删除该资产类型吗？",okText:"确定",cancelText:"取消",onOk:()=>{U([s]).then(()=>d())}})},w=async s=>{r(s),F(!0),i(!0)},D=()=>{e.validateFields().then(s=>{if(l)K(f.typeId,s).then(()=>{i(!1),d()});else{if(!s.typeId){e.setFields([{name:"typeId",errors:["请输入类型ID"]}]);return}const n={...s,typeId:Number(s.typeId)};H(n).then(()=>{i(!1),d()})}})},O=[{title:"类型ID",dataIndex:"typeId",key:"typeId"},{title:"类型名称",dataIndex:"typeName",key:"typeName"},{title:"操作",key:"action",align:"center",render:(s,n)=>t.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[t.jsx("span",{onClick:()=>w(n),children:"编辑"}),t.jsx("span",{className:"text-red-500",onClick:()=>q(n.typeId),children:"删除"})]})}];return a.useEffect(()=>{A&&l&&e.setFieldsValue(f)},[A]),a.useEffect(()=>{d()},[o,c]),{list:T,roleColumns:O,SearchFormComponent:k,total:I,limit:o,loading:b,isEdit:l,formRef:e,editAssetTypesModalOpen:A,setPage:g,setLimit:x,setSelected:S,setEditAssetTypesModalOpen:i,onFinish:D}},J=()=>{const{list:e,roleColumns:o,SearchFormComponent:x,total:c,limit:g,loading:I,isEdit:u,formRef:b,editAssetTypesModalOpen:m,setPage:y,setLimit:S,setSelected:T,setEditAssetTypesModalOpen:j,onFinish:f}=G();return t.jsxs(t.Fragment,{children:[x,t.jsx(L,{dataSource:e,rowSelection:{onChange:r=>{T(r)}},loading:I,columns:o,bordered:!0,pagination:!1,rowKey:"typeId"}),t.jsx(V,{total:c,className:"flex justify-end mt-2",pageSize:g,onChange:r=>y(r),showSizeChanger:!0,onShowSizeChange:(r,l)=>S(l)}),t.jsx(R,{open:m,title:u?"编辑":"新增",onOk:f,onCancel:()=>j(!1),children:t.jsxs(C,{form:b,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[t.jsx(C.Item,{name:"typeId",label:"类型ID",rules:[{required:!0,message:"请输入类型ID"}],children:t.jsx(h,{type:"number",disabled:u,min:1})}),t.jsx(C.Item,{name:"typeName",label:"类型名称",rules:[{required:!0,message:"请输入类型名称"}],children:t.jsx(h,{})})]})})]})},$=a.memo(J);export{$ as default};
