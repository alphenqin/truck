import{r as n,h6 as b,j as e,Y as E,hk as S,hb as O,ha as h,l as a,V as s,hl as V,m as B,hm as K,hn as $,hd as z,hg as J,S as u,h9 as y,gU as j}from"./vendor-core-BL9Phd6R.js";import{j as Q,x as W,y as X,z as Z}from"./route-login-p179xrQD.js";import{a as i,t as ee,I as te}from"./route-layout-De7MC9tK.js";import{d as ae,u as re,a as ne,b as se}from"./index-KT5W7hGz.js";import{A as l}from"./index-CGF89V7j.js";const ie=()=>{const[c]=b(),[p]=b(),[P,R]=n.useState([]),[A,d]=n.useState(!1),[q,m]=n.useState(!1),[N,f]=n.useState(!1),[T,I]=n.useState(!1),[o,x]=n.useState(),[C,Y]=n.useState(),[k,M]=n.useState(!1),[F,w]=n.useState([]),g=async()=>{const t=await Q();R(t.data)},D=async t=>{if(!t)return;const r=await se(t);w(r.data)},_={GET:"green",POST:"blue",PUT:"orange",DELETE:"red",PATCH:"purple",OPTIONS:"cyan"},H=[{title:"菜单名称",dataIndex:"pageName",align:"center",key:"pageName"},{title:"图标",dataIndex:"pageIcon",align:"center",key:"pageIcon",render:t=>e.jsx(te,{name:t})},{title:"路径",dataIndex:"pagePath",align:"center",key:"pagePath"},{title:"组件名称",dataIndex:"pageComponent",align:"center",key:"pageComponent"},{title:"排序",dataIndex:"pageOrder",align:"center",key:"pageOrder"},{title:"类型",dataIndex:"isOutSite",align:"center",key:"isOutSite",render:t=>t?e.jsx(y,{color:"warning",children:"外链"}):e.jsx(y,{color:"green",children:"内建路由"})},{title:"创建时间",align:"center",dataIndex:"createTime",key:"createTime",render:t=>j(t).format("YYYY-MM-DD HH:mm:ss")},{title:"更新时间",align:"center",dataIndex:"updateTime",key:"updateTime",render:t=>j(t).format("YYYY-MM-DD HH:mm:ss")},{title:"操作",dataIndex:"operation",align:"center",key:"operation",render:(t,r)=>e.jsxs("div",{className:"text-[#00b0f0] flex gap-2 items-center justify-center cursor-pointer",children:[e.jsx(l,{permission:i.permissionDicMap.UPDATE_MENU,children:e.jsx("span",{onClick:()=>{x(r),I(!0),d(!0),c.setFieldsValue(r)},children:"编辑"})}),e.jsx(l,{permission:i.permissionDicMap.ADD_MENU,children:e.jsx("span",{onClick:()=>{x(r),I(!1),d(!0),c.resetFields()},children:"新增菜单"})}),!r?.children?.length&&e.jsx(l,{permission:i.permissionDicMap.GET_PAGE_INTERFACE,children:e.jsx("span",{onClick:async()=>{x(r),await D(r.pageID),f(!0)},children:"资源管理"})}),e.jsx(l,{permission:i.permissionDicMap.UPDATE_MENU,children:e.jsx("span",{className:"text-red-500",onClick:()=>{h.confirm({title:"确认删除",content:"确定要删除该菜单吗？",okText:"确定",cancelText:"取消",onOk:async()=>{await W(r.pageID),await g()}})},children:"删除"})})]})}],U=[{title:"名称",dataIndex:"interfaceName",align:"center",key:"interfaceName"},{title:"路径",dataIndex:"interfacePath",align:"center",key:"interfacePath"},{title:"接口指令",dataIndex:"interfaceDic",align:"center",key:"interfaceDic"},{title:"方法",dataIndex:"interfaceMethod",align:"center",key:"interfaceMethod",render:t=>e.jsx(y,{color:_[t],children:t})},{title:"描述",dataIndex:"interfaceDesc",align:"center",key:"interfaceDesc"},{title:"创建时间",dataIndex:"createTime",align:"center",key:"createTime",render:t=>e.jsx("span",{children:j(t).format("YYYY-MM-DD HH:mm:ss")})},{title:"更新时间",dataIndex:"updateTime",align:"center",key:"updateTime",render:t=>e.jsx("span",{children:j(t).format("YYYY-MM-DD HH:mm:ss")})},{title:"操作",dataIndex:"action",align:"center",key:"action",render:(t,r)=>e.jsxs("div",{className:"text-[#00b0f0] flex gap-2 items-center justify-center cursor-pointer",children:[e.jsx(l,{permission:i.permissionDicMap.UPDATE_PAGE_INTERFACE,children:e.jsx("span",{onClick:()=>{M(!0),Y(r),m(!0),p.setFieldsValue(r)},children:"编辑"})}),e.jsx(l,{permission:i.permissionDicMap.DELETE_PAGE_INTERFACE,children:e.jsx("span",{className:"text-red-500",onClick:()=>{h.confirm({title:"确认删除",content:"确定要删除该资源吗？",okText:"确定",cancelText:"取消",onOk:async()=>{await ae(r.id),await D(r.interfacePageID)}})},children:"删除"})})]})}],L=()=>{c.validateFields().then(async t=>{T?o?.pageID&&await X(o.pageID,t):await Z({...t,ParentPage:o?.pageID}),d(!1),g().then()})},v=()=>{M(!1),m(!0),p.resetFields()},G=()=>{p.validateFields().then(async t=>{k?C?.id&&await re({...C,...t}):await ne({...t,interfacePageID:o?.pageID}),m(!1),await D(o.pageID)})};return n.useEffect(()=>{g().then()},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3 flex justify-between items-center app-card-flat p-4",children:[e.jsx("span",{className:"font-bold",children:"菜单列表"}),e.jsx(l,{permission:i.permissionDicMap.ADD_MENU,children:e.jsx(E,{type:"primary",icon:e.jsx(S,{}),onClick:()=>{x(void 0),c.resetFields(),I(!1),d(!0)},children:"新增"})})]}),e.jsx(O,{columns:H,dataSource:P,bordered:!0,rowKey:"pageID"},"menuTable"),e.jsx(h,{open:A,onCancel:()=>d(!1),title:T?"编辑":"新增",onOk:L,children:e.jsxs(a,{form:c,labelAlign:"left",labelCol:{span:6},autoComplete:"off",children:[e.jsx(a.Item,{label:"菜单名称",name:"pageName",rules:[{required:!0}],children:e.jsx(s,{placeholder:"请输入"})}),e.jsx(a.Item,{label:"路径",name:"pagePath",rules:[{required:!0}],children:e.jsx(s,{allowClear:!0,placeholder:"请输入"})}),e.jsx(a.Item,{label:"图标",name:"pageIcon",rules:[{required:!0}],children:e.jsx(ee,{})}),e.jsx(a.Item,{noStyle:!0,shouldUpdate:!0,rules:[{required:!0}],children:({getFieldValue:t})=>!t("isOutSite")&&e.jsx(a.Item,{label:"组件名称",name:"pageComponent",rules:[{required:!0}],children:e.jsx(s,{allowClear:!0,placeholder:"请输入"})})||null}),e.jsx(a.Item,{label:"排序",name:"pageOrder",rules:[{required:!0}],children:e.jsx(V,{type:"number",style:{width:"100%"},placeholder:"请输入"})}),e.jsx(a.Item,{label:"是否外链",name:"isOutSite",rules:[{required:!0}],initialValue:!1,children:e.jsx(B,{checkedChildren:e.jsx($,{}),unCheckedChildren:e.jsx(K,{})})}),e.jsx(a.Item,{rules:[{required:!0}],noStyle:!0,shouldUpdate:!0,children:({getFieldValue:t})=>t("isOutSite")&&e.jsx(a.Item,{label:"外链",name:"outSiteLink",rules:[{required:!0,type:"url"}],children:e.jsx(s,{allowClear:!0,placeholder:"请输入"})})||null})]})}),e.jsx(z,{open:N,title:"资源管理",width:"70%",onClose:()=>f(!1),extra:e.jsxs(J,{children:[e.jsx(E,{onClick:()=>f(!1),children:"取消"}),e.jsx(l,{permission:i.permissionDicMap.ADD_PAGE_INTERFACE,children:e.jsx(E,{type:"primary",onClick:v,icon:e.jsx(S,{}),children:"新增"})})]}),children:e.jsx(O,{dataSource:F,bordered:!0,columns:U,rowKey:"id"})}),e.jsx(h,{open:q,onCancel:()=>m(!1),onOk:G,title:k?"编辑":"新增",mask:!1,children:e.jsxs(a,{form:p,labelCol:{span:6},autoComplete:"off",children:[e.jsx(a.Item,{label:"名称",name:"interfaceName",rules:[{required:!0}],children:e.jsx(s,{placeholder:"请输入"})}),e.jsx(a.Item,{label:"路径",name:"interfacePath",rules:[{required:!0}],children:e.jsx(s,{placeholder:"请输入"})}),e.jsx(a.Item,{label:"方法",name:"interfaceMethod",rules:[{required:!0}],children:e.jsxs(u,{placeholder:"请输入",children:[e.jsx(u.Option,{value:"GET",children:"GET"}),e.jsx(u.Option,{value:"POST",children:"POST"}),e.jsx(u.Option,{value:"PATCH",children:"PATCH"}),e.jsx(u.Option,{value:"DELETE",children:"DELETE"})]})}),e.jsx(a.Item,{label:"接口指令",name:"interfaceDic",rules:[{required:!0}],children:e.jsx(s,{placeholder:"请输入"})}),e.jsx(a.Item,{label:"描述",name:"interfaceDesc",rules:[{required:!0}],children:e.jsx(s,{placeholder:"请输入"})})]})})]})},pe=n.memo(ie);export{pe as default};
