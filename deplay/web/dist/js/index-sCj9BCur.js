import{h6 as M,r as s,j as e,Y as T,h7 as z,V as i,ha as q,hb as D,hc as L,l as h}from"./vendor-core-BL9Phd6R.js";import{A as m}from"./route-login-r9SQJoz-.js";import{u as _}from"./useSearchForm-DGLxIQDe.js";import"./route-layout-BrOgEPTf.js";const v=t=>m.post({url:"/base/arg/query",data:t}),B=t=>m.post({url:"/base/arg",data:t}),H=(t,r)=>m.patch({url:`/base/arg/update/${t}`,data:r}),U=t=>m.delete({url:"/base/arg/batch-delete",data:t}),W=t=>m.post({url:"/base/arg/export",data:{ids:t},responseType:"blob"}),Y=()=>{const[t]=M(),[r,x]=s.useState(10),[g,j]=s.useState(1),[b,S]=s.useState(0),[A,p]=s.useState(!1),[f,C]=s.useState([]),[y,F]=s.useState([]),[o,l]=s.useState(),[d,R]=s.useState(!1),[I,c]=s.useState(!1),E=[{label:"参数键",name:"argKey",component:e.jsx(i,{allowClear:!0})},{label:"参数名称",name:"argName",component:e.jsx(i,{allowClear:!0})},{label:"参数值",name:"argValue",component:e.jsx(i,{allowClear:!0})}],{SearchFormComponent:N}=_({getDataRequestFn:a=>u(a),onNewRecordFn:()=>{t.resetFields(),R(!1),c(!0)},formItems:E,operateComponent:!!f.length&&e.jsx(T,{type:"primary",icon:e.jsx(z,{}),onClick:()=>W(f.map(Number)),children:"导出"}),formName:"roleSearchUserForm"}),u=a=>{p(!0),v({limit:r,offset:(g-1)*r,...a}).then(n=>{const K=n.data.list.map(k=>({...k,id:k.id??k.argId}));F(K),S(n.data.total)}).finally(()=>{p(!1)})},w=a=>{q.confirm({title:"确认删除",content:"确定要删除该参数吗？",okText:"确认",cancelText:"取消",onOk:()=>{U([a]).then(()=>u())}})},V=async a=>{l(a),R(!0),c(!0)},O=()=>{t.validateFields().then(a=>{if(d&&o){const n={...a,id:o.id};H(o.id,n).then(()=>{c(!1),u()})}else B(a).then(()=>{c(!1),u()})})},P=[{title:"ID",dataIndex:"id",key:"id"},{title:"参数键",dataIndex:"argKey",key:"argKey"},{title:"参数名称",dataIndex:"argName",key:"argName"},{title:"参数值",dataIndex:"argValue",key:"argValue"},{title:"操作",key:"action",align:"center",render:(a,n)=>e.jsxs("div",{className:"gap-2 flex text-[#5bb4ef] items-center cursor-pointer justify-center",children:[e.jsx("span",{onClick:()=>V(n),children:"编辑"}),e.jsx("span",{className:"text-red-500",onClick:()=>w(n.id),children:"删除"})]})}];return s.useEffect(()=>{I&&d&&t.setFieldsValue(o)},[I]),s.useEffect(()=>{u()},[r,g]),{list:y,roleColumns:P,SearchFormComponent:N,total:b,limit:r,loading:A,isEdit:d,formRef:t,editArgsModalOpen:I,setPage:j,setLimit:x,setSelected:C,setEditArgsModalOpen:c,onFinish:O}},$=()=>{const{list:t,roleColumns:r,SearchFormComponent:x,total:g,limit:j,loading:b,isEdit:S,formRef:A,editArgsModalOpen:p,setPage:f,setLimit:C,setSelected:y,setEditArgsModalOpen:F,onFinish:o}=Y();return e.jsxs(e.Fragment,{children:[x,e.jsx(D,{dataSource:t,rowSelection:{onChange:l=>{y(l)}},loading:b,columns:r,bordered:!0,pagination:!1,rowKey:"id"}),e.jsx(L,{total:g,className:"flex justify-end mt-2",pageSize:j,onChange:l=>f(l),showSizeChanger:!0,onShowSizeChange:(l,d)=>C(d)}),e.jsx(q,{open:p,title:S?"编辑":"新增",onOk:o,onCancel:()=>F(!1),children:e.jsxs(h,{form:A,autoComplete:"off",labelAlign:"left",id:"editFormRef",children:[e.jsx(h.Item,{name:"argKey",label:"参数键",rules:[{required:!0}],children:e.jsx(i,{})}),e.jsx(h.Item,{name:"argName",label:"参数名称",rules:[{required:!0}],children:e.jsx(i,{})}),e.jsx(h.Item,{name:"argValue",label:"参数值",rules:[{required:!0}],children:e.jsx(i,{})})]})})]})},Z=s.memo($);export{Z as default};
